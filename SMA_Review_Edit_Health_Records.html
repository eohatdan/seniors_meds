<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Review or Edit Health Records</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 700px;
      margin: 40px auto;
      background-color: #f7f7f7;
    }
    h1 {
      text-align: center;
    }
    ul {
      list-style: none;
      padding: 0;
    }
    li {
      background: #fff;
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
      position: relative;
    }
    .dropdown {
      position: absolute;
      top: 10px;
      right: 10px;
    }
    button, select {
      margin-top: 20px;
      padding: 10px;
      font-size: 1rem;
      border-radius: 5px;
      border: none;
      cursor: pointer;
    }
    .btn-secondary {
      background-color: #6c757d;
      color: white;
    }
    .btn-primary {
      background-color: #007bff;
      color: white;
    }
  </style>
</head>
<body>

  <h1>üßæ Review or Edit Health Records</h1>

  <h3>Conditions</h3>
  <ul id="conditionsList"></ul>

  <h3>Allergies</h3>
  <ul id="allergiesList"></ul>

  <h3>Notes</h3>
  <p id="notesDisplay"></p>

  <button onclick="window.location.href='SMA_Add_Health_Records.html'" class="btn-primary">‚ûï Add Health Record</button>
  <button onclick="window.location.href='index.html'" class="btn-secondary">‚¨ÖÔ∏è Back to Main Menu</button>

  <script>
    function renderList(id, dataArray, recordType) {
      const list = document.getElementById(id);
      list.innerHTML = '';
      dataArray.forEach((item, index) => {
        const li = document.createElement('li');
        li.textContent = item;
        const dropdown = document.createElement('select');
        dropdown.className = 'dropdown';
        const options = ['Options', 'Edit', 'Delete'];
        options.forEach(opt => {
          const option = document.createElement('option');
          option.value = opt;
          option.text = opt;
          dropdown.appendChild(option);
        });
        dropdown.onchange = function() {
          if (this.value === 'Edit') {
            const newValue = prompt(`Edit ${recordType}:`, item);
            if (newValue) {
              dataArray[index] = newValue;
              saveAndRender();
            }
          } else if (this.value === 'Delete') {
            dataArray.splice(index, 1);
            saveAndRender();
          }
          this.value = 'Options';
        };
        li.appendChild(dropdown);
        list.appendChild(li);
      });
    }

    function saveAndRender() {
      const records = {
        conditions: currentConditions,
        allergies: currentAllergies,
        notes: currentNotes
      };
      localStorage.setItem('healthRecords', JSON.stringify(records));
      renderList('conditionsList', currentConditions, 'condition');
      renderList('allergiesList', currentAllergies, 'allergy');
      document.getElementById('notesDisplay').textContent = currentNotes || 'None';
    }

    let currentConditions = [];
    let currentAllergies = [];
    let currentNotes = '';

    function loadHealthRecords() {
      const stored = localStorage.getItem('healthRecords');
      if (stored) {
        const data = JSON.parse(stored);
        currentConditions = data.conditions || [];
        currentAllergies = data.allergies || [];
        currentNotes = data.notes || '';
      }
      saveAndRender();
    }

    window.onload = loadHealthRecords;
  </script>

</body>
</html>
